# Conversational Agent
Conversational Agent is implemented using LangChain. LangChain is a framework for building applications powered by large language models (LLMs).

## Installation
Install required packages:
```
pip install -r requirements.txt
```
Create `.env` file from `example.env` and set environment variables:
```
OPENAI_API_KEY=
SERPAPI_API_KEY=
PINECONE_API_KEY=
PINECONE_ENV=
PINECONE_INDEX=
```
OpenAI API is required to query LLM.

[Serp API](https://serpapi.com/) is used for Google search.

[Pinecone API](https://app.pinecone.io) is used for vector database and knowledge retrieval.

## Quick start
Run cli app to start conversation.
> Note: at the run, it may take some time to initialize vectorstore index.
```
cli.py --config configs/default.yaml
```
Example conversation:
```
>>> Hi! My name is Bob. How are you?
<<< Hello Bob! I'm an AI assistant trained to help with a wide range of tasks. How can I assist you today?
>>> Tell me a joke
<<< Sure, here's a joke for you: Why don't scientists trust atoms? Because they make up everything!
>>> What do know about PacificTech Robotics?
<<< PacificTech Robotics is a company that focuses on research and development in the field of robotics. They explore emerging ... (Information from Knowledge Base)
>>> What type of robots?
<<< At AquaTech Robotics, they specialize in the development and deployment of aquatic robots. Their team is dedicated ... (Information from Knowledge Base)
>>> Where is the location of their headquater?
<<< PacificTech Robotics is headquartered on an island called Raraka in the heart of the Pacific Ocean. (Information from Knowledge Base)
>>> How far is it from Warsaw, Poland?
<<< The distance from Warsaw, Poland varies depending on the mode of transportation. By air, the distance is approximately 1,000 miles. (Searches Web)
>>> Okey, thank you, now please connect me with a real agent
<<< Redirecting to human assistant... (Knows when to redirect to Human)
```

## More details

### Knowledge Base
The agent can retrieve information from the knowledge base to answer questions.
For the knowledge base, Pinecone vector database is used. Langchain supports Pinecone integration out of the box. Using vector database allows to embed, store and retrieve additional knowledge efficiently.

For the purpose of this project, knowledge base source is represented as a file `data/knowledge.txt` about fictional company PacificTech Robotics whick develops robots for aquatic environments. 
The file was generated using ChatGPT.

### Web Search
The agent can search web to answer questions.
Google search is implemented using SerpAPI, which is also integrated into Langchain.

The hardest part is using both knowledge base and Google search in Conversational Agent.
We use ReAct approach in which the Agent is provided with a set of tools that can be used to accomplish user request. The problem is that when user asks non-general queries, the agent do not know which tool to use: knowledge base(s) or Google search.

There are two possible solutions:
1. The agent selects a tool based on a query and tool description. To help the agent 
to select a correct tool (in this cases knowledge base or Google search), each knowledge base tool needs to be described as best as possible. This approch doesnt need manual annotations, as the description(s) can be generated by LLM. 

2. The agent have no problem with distinguishing between general queries and the ones that require Google search or knowledge base. In this case, the seach tool can be implemented as a separate custom chain that first checks if the query can be adressed by retrived information from knowledge base and if not, the query is passed to Google search.

For this project, the first approach is used, as it requires less modifications of avaliable Langchain components.

### Redirection to Human

Connection to a support agent can be triggered by user in a few ways:
1. By writing "\h"
2. By writing a query that contains information about user's intent to connect to a support agent. For example, "I need to talk to a human" or "I need to talk to a support agent".
3. When an exception is raised, the agent automatically redirects to a support agent.

Note, that Human class is mocked as it is beyond project scope.
